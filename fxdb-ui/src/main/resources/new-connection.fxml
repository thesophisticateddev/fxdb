<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>
<?import org.fxsql.components.common.NumericField?>

<VBox xmlns:fx="http://javafx.com/fxml"
      xmlns="http://javafx.com/javafx"
      fx:controller="org.fxsql.controller.NewConnectionController"
      prefHeight="480.0" prefWidth="600.0"
      minHeight="450.0" minWidth="500.0"
      spacing="8.0"
      fillWidth="true">

    <padding>
        <Insets top="20.0" right="20.0" bottom="20.0" left="20.0"/>
    </padding>

    <!-- Connection Name -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Connection Name" minWidth="110.0" prefWidth="110.0"/>
        <TextField fx:id="connectionAliasField" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
    </HBox>

    <!-- Database Type Selection with Driver Status -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Database Type" minWidth="110.0" prefWidth="110.0"/>
        <ComboBox fx:id="connectionTypeComboBox" HBox.hgrow="ALWAYS" maxWidth="Infinity" minWidth="150.0"/>
    </HBox>

    <!-- Driver Status Row -->
    <HBox alignment="CENTER_LEFT" spacing="10.0">
        <Region minWidth="110.0" prefWidth="110.0"/>
        <Label fx:id="driverStatusLabel" text="" HBox.hgrow="ALWAYS"/>
        <Hyperlink fx:id="downloadDriverLink" text="Download Driver" visible="false"/>
    </HBox>

    <!-- Host and Port -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Host" minWidth="110.0" prefWidth="110.0"/>
        <TextField fx:id="hostnameTextField" HBox.hgrow="ALWAYS" maxWidth="Infinity" promptText="localhost"/>
        <Label text="Port" minWidth="35.0"/>
        <NumericField fx:id="databasePortField" prefWidth="70.0" minWidth="60.0"/>
    </HBox>

    <!-- Database Name -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Database" minWidth="110.0" prefWidth="110.0"/>
        <TextField fx:id="databaseNameTextField" HBox.hgrow="ALWAYS" maxWidth="Infinity" promptText="mydatabase"/>
    </HBox>

    <!-- Username and Password in same row for compact layout -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Username" minWidth="110.0" prefWidth="110.0"/>
        <TextField fx:id="userTextField" HBox.hgrow="ALWAYS" maxWidth="Infinity" promptText="user"/>
    </HBox>

    <HBox alignment="CENTER_LEFT" spacing="10.0" HBox.hgrow="ALWAYS">
        <Label text="Password" minWidth="110.0" prefWidth="110.0"/>
        <PasswordField fx:id="passwordTextField" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
    </HBox>

    <!-- Connection String (read-only) -->
    <VBox spacing="5.0" VBox.vgrow="NEVER">
        <Label text="Connection String (auto-generated)" style="-fx-font-size: 11px; -fx-text-fill: #666;"/>
        <TextField fx:id="connectionStringTextField" editable="false"
                   style="-fx-background-color: #f5f5f5; -fx-font-family: monospace;"
                   HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
    </VBox>

    <!-- Spacer to push buttons to bottom -->
    <Region VBox.vgrow="ALWAYS"/>

    <!-- Download Progress (hidden by default) -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" managed="${downloadProgress.visible}">
        <Label text="Downloading..." minWidth="110.0"/>
        <ProgressBar fx:id="downloadProgress" HBox.hgrow="ALWAYS" maxWidth="Infinity" visible="false" prefHeight="20.0"/>
    </HBox>

    <!-- Separator -->
    <Separator/>

    <!-- Status and Action Buttons -->
    <HBox alignment="CENTER_LEFT" spacing="10.0" minHeight="40.0">
        <Button fx:id="tryConnection" text="Test Connection" minWidth="110.0" prefWidth="120.0"/>
        <ProgressIndicator fx:id="connectionProgressIndicator" prefHeight="24.0" prefWidth="24.0" visible="false"/>
        <Text fx:id="connectionStatus" wrappingWidth="200.0"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button text="Cancel" minWidth="80.0" onAction="#onCancel"/>
        <Button fx:id="connectionButton" text="Connect" onAction="#onConnect"
                minWidth="100.0" prefWidth="110.0"
                style="-fx-background-color: #0078d4; -fx-text-fill: white; -fx-font-weight: bold;"/>
    </HBox>
</VBox>